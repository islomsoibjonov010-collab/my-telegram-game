<!DOCTYPE html>
<html>
<head>
    <title>Puzzle O'yini</title>
    <style>
        body {
            margin: 0;
            padding: 10px;
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            text-align: center;
            font-family: Arial;
        }
        .header {
            background: rgba(0,0,0,0.3);
            padding: 15px;
            border-radius: 15px;
            margin-bottom: 15px;
        }
        .puzzle-container {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 5px;
            max-width: 300px;
            margin: 15px auto;
            background: rgba(255,255,255,0.1);
            padding: 10px;
            border-radius: 10px;
        }
        .puzzle-piece {
            width: 90px;
            height: 90px;
            background: linear-gradient(45deg, #ff6b6b, #ffd93d);
            border: 2px solid white;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            cursor: grab;
            transition: all 0.3s ease;
            user-select: none;
        }
        .puzzle-piece:hover {
            transform: scale(1.05);
            background: linear-gradient(45deg, #4ecdc4, #556270);
        }
        .puzzle-piece.correct {
            background: linear-gradient(45deg, #00b09b, #96c93d);
            cursor: default;
        }
        .empty-piece {
            width: 90px;
            height: 90px;
            background: rgba(255,255,255,0.2);
            border: 2px dashed white;
            border-radius: 8px;
        }
        .controls {
            margin: 20px;
        }
        button {
            background: linear-gradient(45deg, #ff6b6b, #ffd93d);
            color: #333;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            font-size: 16px;
            cursor: pointer;
            margin: 10px;
            font-weight: bold;
        }
        .stats {
            background: rgba(255,255,255,0.1);
            padding: 10px;
            border-radius: 10px;
            margin: 10px auto;
            max-width: 300px;
        }
        .win-message {
            font-size: 20px;
            font-weight: bold;
            margin: 15px;
            padding: 15px;
            background: rgba(255,255,255,0.2);
            border-radius: 10px;
            animation: celebrate 0.6s ease 3;
        }
        @keyframes celebrate {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
        .level-indicator {
            background: rgba(255,255,255,0.2);
            padding: 5px 15px;
            border-radius: 20px;
            display: inline-block;
            margin: 10px;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ðŸ§© PUZZLE O'YINI</h1>
        <p>Raqamlarni to'g'ri tartibda joylashtiring!</p>
        <div class="level-indicator">Daraja: <b id="level">1</b></div>
    </div>
    
    <div class="stats">
        <div>Harakat: <b id="moves">0</b></div>
        <div>Vaqt: <b id="timer">0</b> soniya</div>
    </div>
    
    <div class="puzzle-container" id="puzzleContainer"></div>
    
    <div class="win-message" id="winMessage"></div>
    
    <div class="controls">
        <button onclick="startGame()">ðŸ”„ Yangi O'yin</button>
        <button onclick="nextLevel()">ðŸš€ Keyingi Daraja</button>
        <button onclick="showHint()">ðŸ’¡ Maslahat</button>
    </div>

    <script>
        let currentLevel = 1;
        let moves = 0;
        let timer = 0;
        let timerInterval;
        let gameCompleted = false;
        
        const levels = {
            1: [1, 2, 3, 4, 5, 6, 7, 8, 0], // 3x3
            2: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 0], // 4x4
            3: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 0] // 5x5
        };
        
        const gridSizes = {
            1: 3,
            2: 4, 
            3: 5
        };
        
        function createPuzzle() {
            const gridSize = gridSizes[currentLevel];
            const puzzleContainer = document.getElementById('puzzleContainer');
            puzzleContainer.innerHTML = '';
            puzzleContainer.style.gridTemplateColumns = `repeat(${gridSize}, 1fr)`;
            
            let pieces = [...levels[currentLevel]];
            pieces = shuffleArray(pieces);
            
            pieces.forEach((number, index) => {
                const piece = document.createElement('div');
                
                if (number === 0) {
                    piece.className = 'empty-piece';
                    piece.dataset.number = '0';
                } else {
                    piece.className = 'puzzle-piece';
                    piece.textContent = number;
                    piece.dataset.number = number;
                    piece.draggable = true;
                    
                    piece.addEventListener('dragstart', (e) => {
                        if (!gameCompleted) {
                            e.dataTransfer.setData('text/plain', number);
                        }
                    });
                    
                    piece.addEventListener('click', () => {
                        if (!gameCompleted) {
                            movePiece(piece);
                        }
                    });
                }
                
                puzzleContainer.appendChild(piece);
            });
        }
        
        function movePiece(piece) {
            const emptyPiece = document.querySelector('.empty-piece');
            const pieceIndex = Array.from(piece.parentNode.children).indexOf(piece);
            const emptyIndex = Array.from(emptyPiece.parentNode.children).indexOf(emptyPiece);
            
            const gridSize = gridSizes[currentLevel];
            const pieceRow = Math.floor(pieceIndex / gridSize);
            const pieceCol = pieceIndex % gridSize;
            const emptyRow = Math.floor(emptyIndex / gridSize);
            const emptyCol = emptyIndex % gridSize;
            
            // Faqat qo'shni katakchalarga ko'chirish mumkin
            const isAdjacent = 
                (Math.abs(pieceRow - emptyRow) === 1 && pieceCol === emptyCol) ||
                (Math.abs(pieceCol - emptyCol) === 1 && pieceRow === emptyRow);
            
            if (isAdjacent) {
                moves++;
                document.getElementById('moves').textContent = moves;
                
                // Almashish
                const pieceNumber = piece.dataset.number;
                const pieceContent = piece.textContent;
                const pieceClass = piece.className;
                
                piece.dataset.number = '0';
                piece.textContent = '';
                piece.className = 'empty-piece';
                piece.draggable = false;
                
                emptyPiece.dataset.number = pieceNumber;
                emptyPiece.textContent = pieceContent;
                emptyPiece.className = pieceClass;
                emptyPiece.draggable = true;
                
                // Harakatlanish
                emptyPiece.addEventListener('click', function moveHandler() {
                    if (!gameCompleted) {
                        movePiece(emptyPiece);
                    }
                });
                
                // G'alaba tekshirish
                checkWin();
            }
        }
        
        function checkWin() {
            const pieces = Array.from(document.querySelectorAll('[data-number]'));
            const currentOrder = pieces.map(piece => parseInt(piece.dataset.number));
            const winOrder = levels[currentLevel];
            
            const isWin = currentOrder.every((num, index) => num === winOrder[index]);
            
            if (isWin) {
                gameCompleted = true;
                clearInterval(timerInterval);
                
                const winMessage = document.getElementById('winMessage');
                winMessage.innerHTML = `
                    ðŸŽ‰ TABRIKLAYMAN! PUZZLENI YECHIB BO'LDINGIZ!<br>
                    Daraja: <b>${currentLevel}</b><br>
                    Harakatlar: <b>${moves}</b><br>
                    Vaqt: <b>${timer}</b> soniya
                `;
            }
        }
        
        function startGame() {
            currentLevel = 1;
            moves = 0;
            timer = 0;
            gameCompleted = false;
            
            document.getElementById('moves').textContent = '0';
            document.getElementById('timer').textContent = '0';
            document.getElementById('level').textContent = '1';
            document.getElementById('winMessage').innerHTML = '';
            
            clearInterval(timerInterval);
            timerInterval = setInterval(() => {
                if (!gameCompleted) {
                    timer++;
                    document.getElementById('timer').textContent = timer;
                }
            }, 1000);
            
            createPuzzle();
        }
        
        function nextLevel() {
            if (currentLevel < 3) {
                currentLevel++;
                moves = 0;
                timer = 0;
                gameCompleted = false;
                
                document.getElementById('moves').textContent = '0';
                document.getElementById('timer').textContent = '0';
                document.getElementById('level').textContent = currentLevel;
                document.getElementById('winMessage').innerHTML = '';
                
                clearInterval(timerInterval);
                timerInterval = setInterval(() => {
                    if (!gameCompleted) {
                        timer++;
                        document.getElementById('timer').textContent = timer;
                    }
                }, 1000);
                
                createPuzzle();
            } else {
                alert("ðŸŽŠ Siz barcha darajalarni yakunladingiz! Mukammal!");
            }
        }
        
        function showHint() {
            if (!gameCompleted) {
                alert("ðŸ’¡ Maslahat: Bo'sh katakchani atrofidagi raqamlarni siljiting!");
            }
        }
        
        function shuffleArray(array) {
            // Fisher-Yates aralashtirish algoritmi
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }
        
        // O'yinni boshlash
        startGame();
    </script>
</body>
</html>
